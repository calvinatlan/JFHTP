<!doctype html> 
<html lang="en"> 
<head>
		<script type="text/javascript" src="js/phaser.min.js"></script>
</head>
<body>

<script type="text/javascript">

var game = new Phaser.Game(800,600, Phaser.AUTO, '', {preload: preload, create: create, update: update});

function preload() {
	game.load.image('sky','assets/sky.png');
	game.load.image('ground', 'assets/platform.png');
    game.load.spritesheet('dude','assets/dude.png',32,48);
}

var player;
var platforms;
var cursors;

function create() {

	//Initialize Physics
	game.physics.startSystem(Phaser.Physics.ARCADE);

	//Add tileSprite background
	game.add.tileSprite(0, 0, 600, 1600, 'sky');

	//Set bounds for camera usage
	game.world.setBounds(0,0, 600, 1600);

	
	//Create platforms
	platforms = game.add.group();

	platforms.enableBody = true;

	var ground = platforms.create(0, game.world.height - 128, 'ground');

	ground.body.immovable = true;

	ground = addPlatform(ground, 400, 250);

	/*ground = platforms.create(400, game.world.height - 250, 'ground');

	ground.body.immovable = true;*/


	//Create player
	player = game.add.sprite(10,game.world.height-200,'dude');

	game.physics.arcade.enable(player);

	player.body.gravity.y = 300;

	player.body.bounce.y = 0.2;

	player.animations.add('left', [0, 1, 2, 3], 10, true);
	player.animations.add('right', [5, 6, 7, 8], 10, true);

	player.frame = 4;

	//Create controls
	spaceKey = game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);


}

function update(){
	
	game.physics.arcade.collide(player, platforms);
	playerAccel(2, 200);
	if (player.body.velocity.x > 0) player.animations.play('right');
	spaceKey.onDown.add(jump, this);

	//Camera
	game.camera.follow(player);

}

function playerAccel(x, y){
	if (player.body.velocity.x < y) player.body.velocity.x += x;
}

function addPlatform(ground, x, y){
	ground = platforms.create(x, game.world.height - y, 'ground');
	ground.body.immovable = true;
	return ground;
}

function jump(){
	if (player.body.touching.down) player.body.velocity.y -= 300;
}
	
</script>
	
</body>
</html>
